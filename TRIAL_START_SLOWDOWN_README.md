# üöÄ Syst√®me de Ralentissement IA Multi-Types

## üéØ Fonctionnalit√© Impl√©ment√©e

Le syst√®me de ralentissement de l'IA multi-types permet de donner aux participants humains le temps n√©cessaire pour :
- **S'orienter** dans le nouveau layout (ralentissement de d√©but d'essai)
- **Percevoir les changements d'intention** de l'IA concernant les ingr√©dients/objets (ralentissement d'asset)
- **Comprendre les changements de strat√©gie** de l'IA concernant les recettes (ralentissement de recette)

## üìã Configuration

### Nouveaux Param√®tres Ajout√©s

```json
{
    "ai_trial_start_slowdown": true,      // Active le ralentissement au d√©but des essais
    "ai_trial_start_duration": 60,       // Dur√©e du ralentissement en ticks
    "ai_trial_start_speed": 20,          // Vitesse sp√©cifique pour le d√©but d'essai
    "ai_trial_start_first_only": false,  // Si true, seulement le premier essai du bloc
    "ai_asset_slowdown_enabled": true,   // Active le ralentissement pour changements d'asset
    "ai_asset_slow_speed": 60,           // Vitesse pendant ralentissement d'asset
    "ai_asset_slow_duration": 40         // Dur√©e du ralentissement d'asset en ticks
}
```

### Param√®tres Existants Utilis√©s

```json
{
    "ai_slowdown_enabled": true,          // Doit √™tre activ√© pour le syst√®me de ralentissement
    "ai_base_speed": 4,                   // Vitesse normale de l'IA
    "ai_slow_speed": 100,                 // Vitesse pour changements de recette
    "ai_slow_duration": 100               // Dur√©e des ralentissements de recette
}
```

## ‚ö° Syst√®me de Vitesses Triples

Le syst√®me supporte maintenant **trois types de ralentissement distincts** :

### 1. Ralentissement de D√©but d'Essai
- **Vitesse** : `ai_trial_start_speed` (ex: 20 ticks par action)
- **D√©clencheur** : Automatique au d√©but de chaque essai
- **Dur√©e** : `ai_trial_start_duration` ticks
- **Priorit√©** : **MAXIMALE**

### 2. Ralentissement de Changement d'Asset
- **Vitesse** : `ai_asset_slow_speed` (ex: 60 ticks par action)
- **D√©clencheur** : Quand l'IA change d'intention d'ingr√©dient/objet
- **Dur√©e** : `ai_asset_slow_duration` ticks
- **Priorit√©** : **√âLEV√âE**
- **Assets d√©tect√©s** : Oignon (O), Tomate (T), Marmite (P), Soupe (S), Livraison (D), Autre (X)

### 3. Ralentissement de Changement de Recette
- **Vitesse** : `ai_slow_speed` (ex: 100 ticks par action)
- **D√©clencheur** : Quand l'IA change d'intention de recette
- **Dur√©e** : `ai_slow_duration` ticks
- **Priorit√©** : **STANDARD**

### üî• Syst√®me de Priorit√©
Quand plusieurs ralentissements sont actifs simultan√©ment :
1. **D√©but d'essai** a la priorit√© maximale
2. **Changement d'asset** a la priorit√© √©lev√©e
3. **Changement de recette** a la priorit√© standard
4. **Vitesse normale** par d√©faut

## ‚öôÔ∏è Options de Configuration

### 1. Ralentissement √† Chaque Essai (Recommand√©)
```json
{
    "ai_trial_start_slowdown": true,
    "ai_trial_start_duration": 60,
    "ai_trial_start_speed": 20,
    "ai_trial_start_first_only": false
}
```
- **Effet** : L'IA ralentit au d√©but de chaque nouvel essai
- **Usage** : Exp√©riences o√π chaque essai a un layout diff√©rent

### 2. Ralentissement Premier Essai Seulement
```json
{
    "ai_trial_start_slowdown": true,
    "ai_trial_start_duration": 90,
    "ai_trial_start_speed": 25,
    "ai_trial_start_first_only": true
}
```
- **Effet** : L'IA ralentit seulement au premier essai de chaque bloc
- **Usage** : Exp√©riences avec des blocs th√©matiques

### 3. Syst√®me Complet avec Assets (Recommand√© pour Recherche)
```json
{
    "ai_slowdown_enabled": true,
    "ai_base_speed": 4,
    "ai_slow_speed": 100,
    "ai_trial_start_speed": 20,
    "ai_asset_slow_speed": 60,
    "ai_slow_duration": 120,
    "ai_trial_start_duration": 60,
    "ai_asset_slow_duration": 40,
    "ai_trial_start_slowdown": true,
    "ai_trial_start_first_only": false,
    "ai_asset_slowdown_enabled": true
}
```
- **Effet** : Tous les types de ralentissement actifs
- **Usage** : Exp√©riences compl√®tes avec signalement d'intentions multi-niveaux

### 4. Ralentissement d'Asset Seulement
```json
{
    "ai_slowdown_enabled": true,
    "ai_base_speed": 4,
    "ai_asset_slowdown_enabled": true,
    "ai_asset_slow_speed": 50,
    "ai_asset_slow_duration": 30,
    "ai_trial_start_slowdown": false
}
```
- **Effet** : Ralentissement uniquement lors des changements d'intention d'ingr√©dient/objet
- **Usage** : √âtude sp√©cifique des intentions d'assets

### 5. Ralentissement D√©sactiv√©
```json
{
    "ai_trial_start_slowdown": false,
    "ai_asset_slowdown_enabled": false
}
```
- **Effet** : Aucun ralentissement automatique
- **Usage** : Conditions de contr√¥le ou exp√©riences sans besoin d'orientation

## üéÆ Fonctionnement en Jeu

### D√©clenchement des Ralentissements

#### 1. Ralentissement de D√©but d'Essai
- **Quand** : Automatiquement lors de l'appel √† `game.activate()` au d√©but d'un essai
- **Condition** : Si `ai_trial_start_slowdown: true` et `ai_slowdown_enabled: true`
- **Dur√©e** : Nombre de ticks sp√©cifi√© par `ai_trial_start_duration`

#### 2. Ralentissement de Changement d'Asset
- **Quand** : Quand l'agent IA change d'intention d'ingr√©dient/objet
- **Condition** : Si `ai_asset_slowdown_enabled: true` et `ai_slowdown_enabled: true`
- **Dur√©e** : Nombre de ticks sp√©cifi√© par `ai_asset_slow_duration`
- **Assets d√©tect√©s** :
  - **O** : Oignon (Onion)
  - **T** : Tomate (Tomato)
  - **P** : Marmite (Pot)
  - **S** : Soupe (Soup)
  - **D** : Livraison (Deliver)
  - **X** : Autre action

#### 3. Ralentissement de Changement de Recette
- **Quand** : Quand l'agent IA change d'intention de recette
- **Condition** : Si `ai_slowdown_enabled: true`
- **Dur√©e** : Nombre de ticks sp√©cifi√© par `ai_slow_duration`

### Effet Visible
- **Vitesse normale** : L'IA re√ßoit des mises √† jour toutes les `ai_base_speed` frames (ex: 4)
- **Vitesse d√©but d'essai** : L'IA re√ßoit des mises √† jour toutes les `ai_trial_start_speed` frames (ex: 20)
- **Vitesse changement asset** : L'IA re√ßoit des mises √† jour toutes les `ai_asset_slow_speed` frames (ex: 60)
- **Vitesse changement recette** : L'IA re√ßoit des mises √† jour toutes les `ai_slow_speed` frames (ex: 100)
- **Retour automatique** : Apr√®s la dur√©e sp√©cifi√©e, retour √† la vitesse normale

### Logs de D√©bogage
```
[AI_SLOWDOWN] Trial start slowdown triggered for 60 ticks at speed 20
[AI_SLOWDOWN] Speed changed to TRIAL START SLOW: 20 (remaining: 59)
[AI_SLOWDOWN] Asset intention changed: Onion -> Tomato
[AI_SLOWDOWN] Triggering asset slowdown for 40 ticks
[AI_SLOWDOWN] Speed changed to ASSET CHANGE SLOW: 60 (remaining: 39)
[AI_SLOWDOWN] Recipe intention changed: None -> onion (triggering slowdown for 100 ticks)
[AI_SLOWDOWN] Speed changed to RECIPE CHANGE SLOW: 100 (remaining: 99)
[AI_SLOWDOWN] Speed returned to NORMAL: 4
```

## üîó Interaction avec le Syst√®me Multi-Types

### Compatibilit√©
- **Triple compatibilit√©** : Les trois types de ralentissement fonctionnent ensemble
- **Syst√®me de priorit√© avanc√©** : 
  1. D√©but d'essai (priorit√© maximale)
  2. Changement d'asset (priorit√© √©lev√©e)
  3. Changement de recette (priorit√© standard)
- **Vitesses ind√©pendantes** : Chaque type a sa propre vitesse et dur√©e

### Exemple de S√©quence Complexe
1. **D√©but d'essai** : Ralentissement automatique (vitesse 20, dur√©e 60 ticks)
2. **Pendant le ralentissement** : L'IA change d'asset ‚Üí m√©moris√© mais pas appliqu√©
3. **Fin du ralentissement de d√©but** : Application du ralentissement d'asset (vitesse 60, dur√©e 40 ticks)
4. **Pendant ralentissement d'asset** : Changement de recette ‚Üí m√©moris√©
5. **Fin du ralentissement d'asset** : Application du ralentissement de recette (vitesse 100, dur√©e 120 ticks)
6. **Fin de tous les ralentissements** : Retour √† la vitesse normale (4)

## üìä Param√®tres Recommand√©s

### Pour des Layouts Complexes avec Signalement d'Intentions
```json
{
    "ai_trial_start_slowdown": true,
    "ai_trial_start_duration": 90,      // Plus long pour analyser
    "ai_trial_start_speed": 25,         // Plus lent pour observation
    "ai_trial_start_first_only": false,
    "ai_asset_slowdown_enabled": true,
    "ai_asset_slow_speed": 50,          // Ralentissement mod√©r√© pour assets
    "ai_asset_slow_duration": 35        // Dur√©e suffisante pour perception
}
```

### Pour des Exp√©riences avec Blocs
```json
{
    "ai_trial_start_slowdown": true,
    "ai_trial_start_duration": 80,      // Orientation √©tendue
    "ai_trial_start_first_only": true   // Seulement premier essai du bloc
}
```

### Pour des Essais Courts
```json
{
    "ai_trial_start_slowdown": true,
    "ai_trial_start_duration": 30,      // Ralentissement bref
    "ai_trial_start_first_only": false
}
```

## üß™ Validation

### Tests Effectu√©s
- ‚úÖ **D√©clenchement automatique** au d√©but d'essai
- ‚úÖ **Dur√©e correcte** du ralentissement
- ‚úÖ **Mode "premier seulement"** fonctionne
- ‚úÖ **D√©sactivation** possible
- ‚úÖ **Retour √† la vitesse normale** automatique
- ‚úÖ **Compatibilit√©** avec le syst√®me existant

### Configurations Test√©es
- ‚úÖ Sections `test_voice_intention`, `test_voice_intention_layout`
- ‚úÖ Param√®tres globaux du fichier de configuration
- ‚úÖ Diff√©rentes dur√©es et options

## üöÄ Utilisation

### Pour Activer dans une Exp√©rience
1. **√âditer** la section de configuration correspondante dans `config.json`
2. **Ajouter** les param√®tres de ralentissement au d√©but d'essai
3. **Tester** avec diff√©rentes dur√©es selon les besoins
4. **Observer** les logs pour v√©rifier le bon fonctionnement

### Exemple d'Int√©gration
```json
"mon_experience": {
    "mechanic": "recipe",
    "gameTime": 120,
    "ai_slowdown_enabled": true,
    "ai_base_speed": 4,
    "ai_slow_speed": 15,
    "ai_slow_duration": 20,
    
    // Nouveaux param√®tres pour le d√©but d'essai
    "ai_trial_start_slowdown": true,
    "ai_trial_start_duration": 45,
    "ai_trial_start_first_only": false
}
```

## ‚úÖ Statut

**üéâ IMPL√âMENT√â ET TEST√â** : Le syst√®me de ralentissement au d√©but d'essai est pleinement fonctionnel et pr√™t pour utilisation en production.

---

*Syst√®me impl√©ment√© le : $(date)*
*Validation compl√®te effectu√©e*
